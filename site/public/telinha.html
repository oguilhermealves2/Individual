<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="js/funcoes.js"></script>
  <title>Home</title>
  <link rel="stylesheet" href="css/interacao.css">
  <link rel="stylesheet" href="">
</head>

<body>

  <!---Cabecario universal-->

  <div class="container">
    <header>
      <div class="navbar-logo">
        <img class="logo" src="assets/logo3attt.png" alt="" />
      </div>
      <div class="logo-peixes">
          <img src="assets/logo 1.png" alt="">
      </div>
    </header>
  </div>

  <!---Fim do cabecario-->


  <div class="container-quiz">
    <div class="cabecario-quiz">
      <span>Pontuação <span id="pontuacao">0</span></span>
      <span id="cronometro">0</span>
    </div>

    <!--Primeira parte da telinha-->

    <div class="questoes-quiz">
      <div class="caixas_de_perguntas ativar">
        <h4>1. Quantos paẽs e peixes Jesus multiplicou relatado no livro de Mateus?</h4>
        <div class="perguntas">
          <input type="radio" name="a1">
          <span>cinco paẽs e dois peixes</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a1" valid="valid">
          <span>onze paẽs e três peixes</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a1">
          <span>Um pão e um peixe</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a1">
          <span>Três peixes e dois pães</span>
        </div>
      </div>

      <!--Segunda parte da telinha-->

      <div class="caixas_de_perguntas">
        <h4>2. Quantas ovelhas se perderam</h4>
        <div class="perguntas">
          <input type="radio" name="a2">
          <span>100</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a2">
          <span>99</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a2">
          <span>98</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a2" valid="valid">
          <span>97</span>
        </div>
      </div>

      <!--Terceira parte da telinha-->

      <div class="caixas_de_perguntas">
        <h4>3. Quantas vezes precisamos perdoar nosso irmão?</h4>
        <div class="perguntas">
          <input type="radio" name="a3">
          <span>70X7</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a3" valid="valid">
          <span>78x9</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a3">
          <span>49x9</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a3">
          <span>36x8</span>
        </div>
      </div>

      <!--Quarta parte da telinha-->

      <div class="caixas_de_perguntas">
        <h4>4. Quantos milagres Jesus realizou?</h4>
        <div class="perguntas">
          <input type="radio" name="a4">
          <span>18</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a4">
          <span>10</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a4" valid="valid">
          <span>28</span>
        </div>
        <div class="perguntas">
          <input type="radio" name="a4">
          <span>90</span>
        </div>
      </div>

      <!--Quarta parte da telinha-->


      <div class="caixas_de_perguntas ativar">
        <h4>Sua pontuação total: <span id="totalpontuacao">0</span> de 100</h4>
      </div>
    </div>
    <div class="footer_quiz">
      <span class="btn1" id="proxima">Próximo</span>
      <button class="finalizar" onclick="cadastroQuiz()">Finalizar</button>
      <button class="tentarNovamente" onclick="TentarNovamente()">Tente +1</button>
    </div>
  </div>

  <script type="text/javascript" src="js/interacao.js"></script>
</body>

</html>

<script>

  function cadastro() {
    window.location = 'cadastro.html'
  }

  function login() {
    window.location = 'login.html'
  }


  /*JS DA INTERAÇÃO */

  var proxima = document.getElementById('proxima')
  var pontuacao = document.getElementById('pontuacao')
  var totalpontuacao = document.getElementById('totalpontuacao')
  var cronometro = document.getElementById('cronometro')
  var contador = 0
  var pontuacaoContador = 0
  var duracao = 0
  var caixasP = document.querySelectorAll('.caixas_de_perguntas')
  var perg = document.querySelectorAll('.caixas_de_perguntas .perguntas input')

  proxima.addEventListener('click', function () {
    step()
    duracao = 10
  })

  perg.forEach(function (pergOne) {
    pergOne.addEventListener('click', function () {
      setTimeout(function () {
        step()
        duracao = 10
      }, 500)

      var valid = this.getAttribute("valid");
      if (valid == "valid") {
        pontuacaoContador += 25;
        errosContador = 100 - pontuacaoContador;
        pontuacao.innerHTML = pontuacaoContador;
        totalpontuacao.innerHTML = pontuacaoContador;
      }

    })
  });

  function step() {
    contador += 1
    for (var i = 0; i < caixasP.length; i++) {
      caixasP[i].className = 'caixas_de_perguntas'
    }
    caixasP[contador].className = 'caixas_de_perguntas ativar'
    if (contador == 5) {
      proxima.style.display = 'none'
      clearInterval(duracaoTime);
      cronometro.innerHTML = 0
    }
  }

  var duracaoTime = setInterval(function () {
    if (duracao == 10) {
      duracao = 0
    }
    duracao += 1
    cronometro.innerHTML = duracao;
    if (cronometro.innerHTML == "10") {
      step()
    }

  }, 1000)


  /*jogando o quiz pro banco */

  function TentarNovamente() {
    window.location = 'start.html'
  }


  function cadastroQuiz() {
    var fkVar = sessionStorage.ID_USUARIO;
    var acertosVar = pontuacaoContador
    var errosVar = errosContador
    console.log(pontuacaoContador + "erro :" + errosContador);
    fetch("/quiz/quizCadastro1", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        acertosServer: acertosVar,
        errosServer: errosVar,
        fkUsuarioServer: fkVar
      })
    }).then(function (resposta) {
      
      window.location = 'start.html'
      console.log("resposta: ", resposta);
      

      if (resposta.ok) {
        cardErro.style.display = "block";

        mensagem_erro.innerHTML = "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

      } else {
        throw ("Houve um erro ao tentar realizar o cadastro!");
      }
    }).catch(function (resposta) {
      console.log(`#ERRO: ${resposta}`);

    });
  }


</script>